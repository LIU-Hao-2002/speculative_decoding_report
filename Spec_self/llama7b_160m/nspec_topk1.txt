[W compiler_depend.ts:615] Warning: expandable_segments currently defaults to false. You can enable this feature by `export PYTORCH_NPU_ALLOC_CONF = expandable_segments:True`. (function operator())
begin loading models: 
 /root/llama160m 
 /root/llama7b
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.71s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.11s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.20s/it]
finish loading models
humaneval:   0%|          | 0/164 [00:00<?, ?it/s]/root/LLMSpeculativeSampling/sampling/utils.py:18: UserWarning: AutoNonVariableTypeMode is deprecated and will be removed in 1.10 release. For kernel implementations please use AutoDispatchBelowADInplaceOrView instead, If you are looking for a user facing API to enable running your inference-only workload, please use c10::InferenceMode. Using AutoDispatchBelowADInplaceOrView in user code is under risk of producing silent wrong result in some edge cases. See Note [AutoDispatchBelowAutograd] for more details. (Triggered internally at build/CMakeFiles/torch_npu.dir/compiler_depend.ts:74.)
  logits[logits < filter[:, [-1]]] = float('-inf')
humaneval:   1%|          | 1/164 [00:28<1:17:18, 28.45s/it]humaneval:   1%|          | 2/164 [00:58<1:19:43, 29.53s/it]humaneval:   2%|▏         | 3/164 [01:30<1:21:30, 30.38s/it]humaneval:   2%|▏         | 4/164 [02:07<1:28:13, 33.09s/it]humaneval:   3%|▎         | 5/164 [02:42<1:29:22, 33.73s/it]humaneval:   4%|▎         | 6/164 [03:15<1:28:23, 33.57s/it]humaneval:   4%|▍         | 7/164 [03:41<1:21:10, 31.02s/it]humaneval:   5%|▍         | 8/164 [04:16<1:24:33, 32.52s/it]humaneval:   5%|▌         | 9/164 [04:55<1:28:38, 34.31s/it]humaneval:   6%|▌         | 10/164 [05:31<1:29:17, 34.79s/it]humaneval:   7%|▋         | 11/164 [06:02<1:26:08, 33.78s/it]humaneval:   7%|▋         | 12/164 [06:36<1:25:27, 33.73s/it]humaneval:   8%|▊         | 13/164 [07:13<1:27:30, 34.77s/it]humaneval:   9%|▊         | 14/164 [07:54<1:31:31, 36.61s/it]humaneval:   9%|▉         | 15/164 [08:28<1:29:28, 36.03s/it]humaneval:  10%|▉         | 16/164 [09:03<1:27:31, 35.48s/it]humaneval:  10%|█         | 17/164 [09:38<1:26:45, 35.41s/it]humaneval:  11%|█         | 18/164 [10:17<1:28:34, 36.40s/it]humaneval:  12%|█▏        | 19/164 [10:53<1:28:12, 36.50s/it]humaneval:  12%|█▏        | 20/164 [11:29<1:27:13, 36.35s/it]humaneval:  13%|█▎        | 21/164 [12:03<1:24:29, 35.45s/it]humaneval:  13%|█▎        | 22/164 [12:41<1:25:40, 36.20s/it]humaneval:  14%|█▍        | 23/164 [13:11<1:20:51, 34.41s/it]humaneval:  15%|█▍        | 24/164 [13:49<1:23:03, 35.60s/it]humaneval:  15%|█▌        | 25/164 [14:29<1:25:41, 36.99s/it]humaneval:  16%|█▌        | 26/164 [15:02<1:21:49, 35.58s/it]humaneval:  16%|█▋        | 27/164 [15:37<1:21:20, 35.62s/it]humaneval:  17%|█▋        | 28/164 [16:12<1:19:57, 35.27s/it]humaneval:  18%|█▊        | 29/164 [16:51<1:21:37, 36.28s/it]humaneval:  18%|█▊        | 30/164 [17:25<1:19:38, 35.66s/it]humaneval:  19%|█▉        | 31/164 [18:00<1:18:35, 35.46s/it]humaneval:  20%|█▉        | 32/164 [18:36<1:18:27, 35.66s/it]humaneval:  20%|██        | 33/164 [19:13<1:18:57, 36.16s/it]humaneval:  21%|██        | 34/164 [19:47<1:16:52, 35.48s/it]humaneval:  21%|██▏       | 35/164 [20:23<1:16:41, 35.67s/it]humaneval:  22%|██▏       | 36/164 [20:57<1:14:55, 35.12s/it]humaneval:  23%|██▎       | 37/164 [21:32<1:14:24, 35.16s/it]humaneval:  23%|██▎       | 38/164 [22:07<1:13:48, 35.15s/it]humaneval:  24%|██▍       | 39/164 [22:36<1:09:24, 33.31s/it]humaneval:  24%|██▍       | 40/164 [23:11<1:09:53, 33.82s/it]humaneval:  25%|██▌       | 41/164 [23:47<1:10:33, 34.42s/it]humaneval:  26%|██▌       | 42/164 [24:23<1:10:59, 34.91s/it]humaneval:  26%|██▌       | 43/164 [24:57<1:09:28, 34.45s/it]humaneval:  27%|██▋       | 44/164 [25:31<1:08:32, 34.27s/it]humaneval:  27%|██▋       | 45/164 [26:08<1:10:03, 35.32s/it]humaneval:  28%|██▊       | 46/164 [26:41<1:08:03, 34.61s/it]humaneval:  29%|██▊       | 47/164 [27:12<1:05:12, 33.44s/it]humaneval:  29%|██▉       | 48/164 [27:45<1:04:31, 33.37s/it]humaneval:  30%|██▉       | 49/164 [28:21<1:05:04, 33.95s/it]humaneval:  30%|███       | 50/164 [28:51<1:02:36, 32.95s/it]humaneval:  31%|███       | 51/164 [29:23<1:01:23, 32.60s/it]humaneval:  32%|███▏      | 52/164 [29:59<1:02:33, 33.51s/it]humaneval:  32%|███▏      | 53/164 [30:35<1:03:49, 34.50s/it]humaneval:  33%|███▎      | 54/164 [31:18<1:07:41, 36.92s/it]humaneval:  34%|███▎      | 55/164 [31:47<1:02:46, 34.55s/it]humaneval:  34%|███▍      | 56/164 [32:20<1:01:15, 34.03s/it]humaneval:  35%|███▍      | 57/164 [32:53<1:00:10, 33.74s/it]humaneval:  35%|███▌      | 58/164 [33:26<59:28, 33.67s/it]  humaneval:  36%|███▌      | 59/164 [33:52<54:52, 31.36s/it]humaneval:  37%|███▋      | 60/164 [34:28<56:31, 32.61s/it]humaneval:  37%|███▋      | 61/164 [35:01<56:15, 32.77s/it]humaneval:  38%|███▊      | 62/164 [35:33<55:21, 32.57s/it]humaneval:  38%|███▊      | 63/164 [36:03<53:15, 31.63s/it]humaneval:  39%|███▉      | 64/164 [36:37<54:04, 32.45s/it]humaneval:  40%|███▉      | 65/164 [37:05<51:23, 31.15s/it]humaneval:  40%|████      | 66/164 [37:38<51:52, 31.77s/it]humaneval:  41%|████      | 67/164 [38:09<50:50, 31.45s/it]humaneval:  41%|████▏     | 68/164 [38:39<49:36, 31.01s/it]humaneval:  42%|████▏     | 69/164 [39:08<48:11, 30.44s/it]humaneval:  43%|████▎     | 70/164 [39:45<50:39, 32.33s/it]humaneval:  43%|████▎     | 71/164 [40:13<48:03, 31.00s/it]humaneval:  44%|████▍     | 72/164 [40:46<48:29, 31.63s/it]humaneval:  45%|████▍     | 73/164 [41:18<48:05, 31.71s/it]humaneval:  45%|████▌     | 74/164 [41:58<51:21, 34.24s/it]humaneval:  46%|████▌     | 75/164 [42:32<50:47, 34.24s/it]humaneval:  46%|████▋     | 76/164 [42:59<47:11, 32.17s/it]humaneval:  47%|████▋     | 77/164 [43:30<46:00, 31.73s/it]humaneval:  48%|████▊     | 78/164 [44:04<46:36, 32.52s/it]humaneval:  48%|████▊     | 79/164 [44:41<47:50, 33.77s/it]humaneval:  49%|████▉     | 80/164 [45:07<43:56, 31.38s/it]humaneval:  49%|████▉     | 81/164 [45:43<45:18, 32.75s/it]humaneval:  50%|█████     | 82/164 [46:16<44:50, 32.81s/it]humaneval:  51%|█████     | 83/164 [46:51<45:27, 33.67s/it]humaneval:  51%|█████     | 84/164 [47:30<46:42, 35.04s/it]humaneval:  52%|█████▏    | 85/164 [47:59<43:46, 33.25s/it]humaneval:  52%|█████▏    | 86/164 [48:27<41:13, 31.71s/it]humaneval:  53%|█████▎    | 87/164 [49:00<41:17, 32.17s/it]humaneval:  54%|█████▎    | 88/164 [49:33<41:08, 32.48s/it]humaneval:  54%|█████▍    | 89/164 [50:08<41:25, 33.14s/it]humaneval:  55%|█████▍    | 90/164 [50:44<41:49, 33.91s/it]humaneval:  55%|█████▌    | 91/164 [51:16<40:46, 33.51s/it]humaneval:  56%|█████▌    | 92/164 [51:51<40:45, 33.96s/it]humaneval:  57%|█████▋    | 93/164 [52:20<38:24, 32.46s/it]humaneval:  57%|█████▋    | 94/164 [52:54<38:20, 32.86s/it]humaneval:  58%|█████▊    | 95/164 [53:30<38:57, 33.87s/it]humaneval:  59%|█████▊    | 96/164 [54:01<37:08, 32.78s/it]humaneval:  59%|█████▉    | 97/164 [54:37<37:42, 33.77s/it]humaneval:  60%|█████▉    | 98/164 [55:11<37:15, 33.88s/it]humaneval:  60%|██████    | 99/164 [55:43<36:13, 33.44s/it]humaneval:  61%|██████    | 100/164 [56:12<34:15, 32.11s/it]humaneval:  62%|██████▏   | 101/164 [56:51<35:43, 34.03s/it]humaneval:  62%|██████▏   | 102/164 [57:27<35:54, 34.75s/it]humaneval:  63%|██████▎   | 103/164 [58:02<35:17, 34.72s/it]humaneval:  63%|██████▎   | 104/164 [58:44<36:52, 36.87s/it]humaneval:  64%|██████▍   | 105/164 [59:19<35:40, 36.28s/it]humaneval:  65%|██████▍   | 106/164 [59:49<33:14, 34.38s/it]humaneval:  65%|██████▌   | 107/164 [1:00:24<32:51, 34.58s/it]humaneval:  66%|██████▌   | 108/164 [1:00:59<32:36, 34.93s/it]humaneval:  66%|██████▋   | 109/164 [1:01:37<32:46, 35.76s/it]humaneval:  67%|██████▋   | 110/164 [1:02:10<31:31, 35.03s/it]humaneval:  68%|██████▊   | 111/164 [1:02:41<29:47, 33.72s/it]humaneval:  68%|██████▊   | 112/164 [1:03:16<29:35, 34.14s/it]humaneval:  69%|██████▉   | 113/164 [1:03:47<28:04, 33.04s/it]humaneval:  70%|██████▉   | 114/164 [1:04:22<28:01, 33.63s/it]humaneval:  70%|███████   | 115/164 [1:04:58<28:09, 34.47s/it]humaneval:  71%|███████   | 116/164 [1:05:30<27:03, 33.83s/it]humaneval:  71%|███████▏  | 117/164 [1:06:06<26:57, 34.41s/it]humaneval:  72%|███████▏  | 118/164 [1:06:41<26:28, 34.53s/it]humaneval:  73%|███████▎  | 119/164 [1:07:10<24:34, 32.77s/it]humaneval:  73%|███████▎  | 120/164 [1:07:45<24:33, 33.49s/it]humaneval:  74%|███████▍  | 121/164 [1:08:14<23:00, 32.10s/it]humaneval:  74%|███████▍  | 122/164 [1:08:49<23:09, 33.08s/it]humaneval:  75%|███████▌  | 123/164 [1:09:25<23:09, 33.89s/it]humaneval:  76%|███████▌  | 124/164 [1:10:02<23:14, 34.85s/it]humaneval:  76%|███████▌  | 125/164 [1:10:34<22:03, 33.95s/it]humaneval:  77%|███████▋  | 126/164 [1:11:09<21:50, 34.47s/it]humaneval:  77%|███████▋  | 127/164 [1:11:45<21:24, 34.72s/it]humaneval:  78%|███████▊  | 128/164 [1:12:16<20:15, 33.75s/it]humaneval:  79%|███████▊  | 129/164 [1:12:47<19:10, 32.88s/it]humaneval:  79%|███████▉  | 130/164 [1:13:30<20:19, 35.87s/it]humaneval:  80%|███████▉  | 131/164 [1:14:05<19:31, 35.50s/it]humaneval:  80%|████████  | 132/164 [1:14:43<19:25, 36.43s/it]humaneval:  81%|████████  | 133/164 [1:15:14<17:55, 34.70s/it]humaneval:  82%|████████▏ | 134/164 [1:15:50<17:33, 35.11s/it]humaneval:  82%|████████▏ | 135/164 [1:16:26<17:10, 35.53s/it]humaneval:  83%|████████▎ | 136/164 [1:17:02<16:33, 35.48s/it]humaneval:  84%|████████▎ | 137/164 [1:17:31<15:05, 33.55s/it]humaneval:  84%|████████▍ | 138/164 [1:18:05<14:38, 33.79s/it]humaneval:  85%|████████▍ | 139/164 [1:18:34<13:28, 32.35s/it]humaneval:  85%|████████▌ | 140/164 [1:19:10<13:23, 33.46s/it]humaneval:  86%|████████▌ | 141/164 [1:19:44<12:53, 33.65s/it]humaneval:  87%|████████▋ | 142/164 [1:20:15<12:02, 32.84s/it]humaneval:  87%|████████▋ | 143/164 [1:20:48<11:30, 32.87s/it]humaneval:  88%|████████▊ | 144/164 [1:21:20<10:50, 32.52s/it]humaneval:  88%|████████▊ | 145/164 [1:21:56<10:41, 33.76s/it]humaneval:  89%|████████▉ | 146/164 [1:22:32<10:16, 34.23s/it]humaneval:  90%|████████▉ | 147/164 [1:23:09<09:58, 35.18s/it]humaneval:  90%|█████████ | 148/164 [1:23:43<09:16, 34.77s/it]humaneval:  91%|█████████ | 149/164 [1:24:22<08:58, 35.90s/it]humaneval:  91%|█████████▏| 150/164 [1:24:51<07:57, 34.09s/it]humaneval:  92%|█████████▏| 151/164 [1:25:28<07:31, 34.70s/it]humaneval:  93%|█████████▎| 152/164 [1:26:03<06:58, 34.91s/it]humaneval:  93%|█████████▎| 153/164 [1:26:38<06:24, 34.99s/it]humaneval:  94%|█████████▍| 154/164 [1:27:18<06:04, 36.41s/it]humaneval:  95%|█████████▍| 155/164 [1:27:52<05:22, 35.84s/it]humaneval:  95%|█████████▌| 156/164 [1:28:31<04:53, 36.68s/it]humaneval:  96%|█████████▌| 157/164 [1:29:06<04:13, 36.15s/it]humaneval:  96%|█████████▋| 158/164 [1:29:34<03:22, 33.77s/it]humaneval:  97%|█████████▋| 159/164 [1:30:06<02:45, 33.16s/it]humaneval:  98%|█████████▊| 160/164 [1:30:43<02:17, 34.31s/it]humaneval:  98%|█████████▊| 161/164 [1:31:14<01:40, 33.47s/it]humaneval:  99%|█████████▉| 162/164 [1:31:49<01:07, 33.75s/it]humaneval:  99%|█████████▉| 163/164 [1:32:23<00:33, 33.94s/it]humaneval: 100%|██████████| 164/164 [1:32:59<00:00, 34.60s/it]humaneval: 100%|██████████| 164/164 [1:32:59<00:00, 34.02s/it]
