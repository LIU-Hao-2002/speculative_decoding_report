[W compiler_depend.ts:615] Warning: expandable_segments currently defaults to false. You can enable this feature by `export PYTORCH_NPU_ALLOC_CONF = expandable_segments:True`. (function operator())
begin loading models: 
 /root/llama7b 
 /root/llama13b
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.75s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.14s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.23s/it]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:02<00:04,  2.02s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:04<00:02,  2.01s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:05<00:00,  1.73s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:05<00:00,  1.81s/it]
finish loading models
humaneval:   0%|          | 0/164 [00:00<?, ?it/s]/root/LLMSpeculativeSampling/sampling/utils.py:18: UserWarning: AutoNonVariableTypeMode is deprecated and will be removed in 1.10 release. For kernel implementations please use AutoDispatchBelowADInplaceOrView instead, If you are looking for a user facing API to enable running your inference-only workload, please use c10::InferenceMode. Using AutoDispatchBelowADInplaceOrView in user code is under risk of producing silent wrong result in some edge cases. See Note [AutoDispatchBelowAutograd] for more details. (Triggered internally at build/CMakeFiles/torch_npu.dir/compiler_depend.ts:74.)
  logits[logits < filter[:, [-1]]] = float('-inf')
humaneval:   1%|          | 1/164 [00:35<1:35:17, 35.08s/it]humaneval:   1%|          | 2/164 [01:09<1:33:59, 34.81s/it]humaneval:   2%|▏         | 3/164 [01:43<1:31:57, 34.27s/it]humaneval:   2%|▏         | 4/164 [02:15<1:28:51, 33.32s/it]humaneval:   3%|▎         | 5/164 [02:50<1:30:06, 34.00s/it]humaneval:   4%|▎         | 6/164 [03:27<1:32:16, 35.04s/it]humaneval:   4%|▍         | 7/164 [04:02<1:31:53, 35.12s/it]humaneval:   5%|▍         | 8/164 [04:38<1:31:54, 35.35s/it]humaneval:   5%|▌         | 9/164 [05:13<1:31:10, 35.30s/it]humaneval:   6%|▌         | 10/164 [05:50<1:31:23, 35.61s/it]humaneval:   7%|▋         | 11/164 [06:22<1:27:57, 34.49s/it]humaneval:   7%|▋         | 12/164 [06:55<1:26:36, 34.19s/it]humaneval:   8%|▊         | 13/164 [07:30<1:26:37, 34.42s/it]humaneval:   9%|▊         | 14/164 [08:09<1:29:25, 35.77s/it]humaneval:   9%|▉         | 15/164 [08:42<1:26:56, 35.01s/it]humaneval:  10%|▉         | 16/164 [09:16<1:25:46, 34.77s/it]humaneval:  10%|█         | 17/164 [09:53<1:26:23, 35.26s/it]humaneval:  11%|█         | 18/164 [10:29<1:26:50, 35.69s/it]humaneval:  12%|█▏        | 19/164 [11:06<1:27:05, 36.04s/it]humaneval:  12%|█▏        | 20/164 [11:41<1:25:42, 35.71s/it]humaneval:  13%|█▎        | 21/164 [12:13<1:22:12, 34.49s/it]humaneval:  13%|█▎        | 22/164 [12:44<1:19:26, 33.57s/it]humaneval:  14%|█▍        | 23/164 [13:22<1:21:28, 34.67s/it]humaneval:  15%|█▍        | 24/164 [13:59<1:23:02, 35.59s/it]humaneval:  15%|█▌        | 25/164 [14:36<1:23:32, 36.06s/it]humaneval:  16%|█▌        | 26/164 [15:11<1:21:53, 35.61s/it]humaneval:  16%|█▋        | 27/164 [15:44<1:19:48, 34.95s/it]humaneval:  17%|█▋        | 28/164 [16:18<1:18:35, 34.67s/it]humaneval:  18%|█▊        | 29/164 [16:53<1:18:03, 34.69s/it]humaneval:  18%|█▊        | 30/164 [17:30<1:18:37, 35.20s/it]humaneval:  19%|█▉        | 31/164 [18:05<1:18:09, 35.26s/it]humaneval:  20%|█▉        | 32/164 [18:38<1:16:25, 34.74s/it]humaneval:  20%|██        | 33/164 [19:09<1:13:16, 33.56s/it]humaneval:  21%|██        | 34/164 [19:43<1:12:32, 33.48s/it]humaneval:  21%|██▏       | 35/164 [20:21<1:15:17, 35.02s/it]humaneval:  22%|██▏       | 36/164 [20:57<1:15:12, 35.25s/it]humaneval:  23%|██▎       | 37/164 [21:32<1:14:41, 35.29s/it]humaneval:  23%|██▎       | 38/164 [22:06<1:12:58, 34.75s/it]humaneval:  24%|██▍       | 39/164 [22:38<1:10:59, 34.08s/it]humaneval:  24%|██▍       | 40/164 [23:15<1:11:54, 34.79s/it]humaneval:  25%|██▌       | 41/164 [23:50<1:11:20, 34.80s/it]humaneval:  26%|██▌       | 42/164 [24:27<1:12:36, 35.71s/it]humaneval:  26%|██▌       | 43/164 [25:00<1:10:02, 34.73s/it]humaneval:  27%|██▋       | 44/164 [25:33<1:08:24, 34.20s/it]humaneval:  27%|██▋       | 45/164 [26:05<1:06:30, 33.53s/it]humaneval:  28%|██▊       | 46/164 [26:39<1:06:12, 33.67s/it]humaneval:  29%|██▊       | 47/164 [27:14<1:06:37, 34.17s/it]humaneval:  29%|██▉       | 48/164 [27:48<1:05:48, 34.04s/it]humaneval:  30%|██▉       | 49/164 [28:22<1:05:22, 34.11s/it]humaneval:  30%|███       | 50/164 [28:57<1:05:07, 34.28s/it]humaneval:  31%|███       | 51/164 [29:30<1:03:47, 33.87s/it]humaneval:  32%|███▏      | 52/164 [30:01<1:01:32, 32.97s/it]humaneval:  32%|███▏      | 53/164 [30:33<1:00:41, 32.81s/it]humaneval:  33%|███▎      | 54/164 [31:09<1:01:45, 33.69s/it]humaneval:  34%|███▎      | 55/164 [31:42<1:00:51, 33.50s/it]humaneval:  34%|███▍      | 56/164 [32:18<1:01:39, 34.25s/it]humaneval:  35%|███▍      | 57/164 [32:49<59:38, 33.45s/it]  humaneval:  35%|███▌      | 58/164 [33:22<58:45, 33.26s/it]humaneval:  36%|███▌      | 59/164 [33:57<58:44, 33.57s/it]humaneval:  37%|███▋      | 60/164 [34:32<58:54, 33.99s/it]humaneval:  37%|███▋      | 61/164 [35:06<58:24, 34.02s/it]humaneval:  38%|███▊      | 62/164 [35:38<57:01, 33.55s/it]humaneval:  38%|███▊      | 63/164 [36:09<55:23, 32.90s/it]humaneval:  39%|███▉      | 64/164 [36:45<55:55, 33.56s/it]humaneval:  40%|███▉      | 65/164 [37:18<55:33, 33.67s/it]humaneval:  40%|████      | 66/164 [37:51<54:25, 33.33s/it]humaneval:  41%|████      | 67/164 [38:23<53:07, 32.86s/it]humaneval:  41%|████▏     | 68/164 [38:58<53:30, 33.45s/it]humaneval:  42%|████▏     | 69/164 [39:30<52:21, 33.07s/it]humaneval:  43%|████▎     | 70/164 [40:02<51:25, 32.82s/it]humaneval:  43%|████▎     | 71/164 [40:35<50:52, 32.82s/it]humaneval:  44%|████▍     | 72/164 [41:08<50:18, 32.81s/it]humaneval:  45%|████▍     | 73/164 [41:40<49:38, 32.73s/it]humaneval:  45%|████▌     | 74/164 [42:20<52:12, 34.81s/it]humaneval:  46%|████▌     | 75/164 [42:51<49:59, 33.70s/it]humaneval:  46%|████▋     | 76/164 [43:22<48:14, 32.89s/it]humaneval:  47%|████▋     | 77/164 [43:56<47:59, 33.09s/it]humaneval:  48%|████▊     | 78/164 [44:27<46:55, 32.74s/it]humaneval:  48%|████▊     | 79/164 [45:01<46:45, 33.01s/it]humaneval:  49%|████▉     | 80/164 [45:36<47:09, 33.69s/it]humaneval:  49%|████▉     | 81/164 [46:11<46:53, 33.90s/it]humaneval:  50%|█████     | 82/164 [46:44<45:52, 33.57s/it]humaneval:  51%|█████     | 83/164 [47:19<46:16, 34.28s/it]humaneval:  51%|█████     | 84/164 [47:53<45:22, 34.04s/it]humaneval:  52%|█████▏    | 85/164 [48:24<43:33, 33.08s/it]humaneval:  52%|█████▏    | 86/164 [48:59<43:55, 33.79s/it]humaneval:  53%|█████▎    | 87/164 [49:33<43:19, 33.76s/it]humaneval:  54%|█████▎    | 88/164 [50:05<42:09, 33.28s/it]humaneval:  54%|█████▍    | 89/164 [50:40<42:22, 33.90s/it]humaneval:  55%|█████▍    | 90/164 [51:13<41:24, 33.58s/it]humaneval:  55%|█████▌    | 91/164 [51:46<40:31, 33.30s/it]humaneval:  56%|█████▌    | 92/164 [52:18<39:32, 32.95s/it]humaneval:  57%|█████▋    | 93/164 [52:54<40:07, 33.91s/it]humaneval:  57%|█████▋    | 94/164 [53:29<39:42, 34.04s/it]humaneval:  58%|█████▊    | 95/164 [54:02<38:59, 33.91s/it]humaneval:  59%|█████▊    | 96/164 [54:34<37:40, 33.24s/it]humaneval:  59%|█████▉    | 97/164 [55:11<38:25, 34.41s/it]humaneval:  60%|█████▉    | 98/164 [55:43<37:02, 33.68s/it]humaneval:  60%|██████    | 99/164 [56:17<36:40, 33.86s/it]humaneval:  61%|██████    | 100/164 [56:49<35:36, 33.39s/it]humaneval:  62%|██████▏   | 101/164 [57:22<34:49, 33.16s/it]humaneval:  62%|██████▏   | 102/164 [57:56<34:32, 33.42s/it]humaneval:  63%|██████▎   | 103/164 [58:32<34:46, 34.20s/it]humaneval:  63%|██████▎   | 104/164 [59:10<35:10, 35.17s/it]humaneval:  64%|██████▍   | 105/164 [59:43<34:03, 34.63s/it]humaneval:  65%|██████▍   | 106/164 [1:00:16<33:05, 34.22s/it]humaneval:  65%|██████▌   | 107/164 [1:00:49<31:59, 33.68s/it]humaneval:  66%|██████▌   | 108/164 [1:01:23<31:30, 33.75s/it]humaneval:  66%|██████▋   | 109/164 [1:01:58<31:18, 34.16s/it]humaneval:  67%|██████▋   | 110/164 [1:02:33<31:09, 34.62s/it]humaneval:  68%|██████▊   | 111/164 [1:03:08<30:40, 34.72s/it]humaneval:  68%|██████▊   | 112/164 [1:03:43<30:11, 34.83s/it]humaneval:  69%|██████▉   | 113/164 [1:04:16<28:58, 34.09s/it]humaneval:  70%|██████▉   | 114/164 [1:04:51<28:34, 34.28s/it]humaneval:  70%|███████   | 115/164 [1:05:24<27:48, 34.05s/it]humaneval:  71%|███████   | 116/164 [1:06:00<27:37, 34.53s/it]humaneval:  71%|███████▏  | 117/164 [1:06:32<26:35, 33.94s/it]humaneval:  72%|███████▏  | 118/164 [1:07:07<26:10, 34.14s/it]humaneval:  73%|███████▎  | 119/164 [1:07:42<25:55, 34.57s/it]humaneval:  73%|███████▎  | 120/164 [1:08:15<24:48, 33.83s/it]humaneval:  74%|███████▍  | 121/164 [1:08:49<24:22, 34.02s/it]humaneval:  74%|███████▍  | 122/164 [1:09:21<23:23, 33.43s/it]humaneval:  75%|███████▌  | 123/164 [1:09:55<22:58, 33.62s/it]humaneval:  76%|███████▌  | 124/164 [1:10:28<22:11, 33.29s/it]humaneval:  76%|███████▌  | 125/164 [1:11:00<21:26, 33.00s/it]humaneval:  77%|███████▋  | 126/164 [1:11:36<21:33, 34.04s/it]humaneval:  77%|███████▋  | 127/164 [1:12:14<21:42, 35.20s/it]humaneval:  78%|███████▊  | 128/164 [1:12:50<21:14, 35.41s/it]humaneval:  79%|███████▊  | 129/164 [1:13:24<20:22, 34.92s/it]humaneval:  79%|███████▉  | 130/164 [1:14:04<20:34, 36.32s/it]humaneval:  80%|███████▉  | 131/164 [1:14:39<19:54, 36.19s/it]humaneval:  80%|████████  | 132/164 [1:15:16<19:17, 36.19s/it]humaneval:  81%|████████  | 133/164 [1:15:52<18:41, 36.18s/it]humaneval:  82%|████████▏ | 134/164 [1:16:27<17:56, 35.90s/it]humaneval:  82%|████████▏ | 135/164 [1:17:05<17:39, 36.55s/it]humaneval:  83%|████████▎ | 136/164 [1:17:42<17:03, 36.56s/it]humaneval:  84%|████████▎ | 137/164 [1:18:16<16:11, 36.00s/it]humaneval:  84%|████████▍ | 138/164 [1:18:50<15:16, 35.26s/it]humaneval:  85%|████████▍ | 139/164 [1:19:25<14:43, 35.35s/it]humaneval:  85%|████████▌ | 140/164 [1:20:01<14:10, 35.43s/it]humaneval:  86%|████████▌ | 141/164 [1:20:39<13:49, 36.06s/it]humaneval:  87%|████████▋ | 142/164 [1:21:13<13:04, 35.65s/it]humaneval:  87%|████████▋ | 143/164 [1:21:50<12:38, 36.10s/it]humaneval:  88%|████████▊ | 144/164 [1:22:26<11:57, 35.86s/it]humaneval:  88%|████████▊ | 145/164 [1:23:04<11:34, 36.56s/it]humaneval:  89%|████████▉ | 146/164 [1:23:36<10:31, 35.08s/it]humaneval:  90%|████████▉ | 147/164 [1:24:11<09:56, 35.06s/it]humaneval:  90%|█████████ | 148/164 [1:24:44<09:11, 34.46s/it]humaneval:  91%|█████████ | 149/164 [1:25:17<08:29, 33.99s/it]humaneval:  91%|█████████▏| 150/164 [1:25:50<07:52, 33.78s/it]humaneval:  92%|█████████▏| 151/164 [1:26:22<07:10, 33.15s/it]humaneval:  93%|█████████▎| 152/164 [1:27:03<07:06, 35.55s/it]humaneval:  93%|█████████▎| 153/164 [1:27:38<06:30, 35.53s/it]humaneval:  94%|█████████▍| 154/164 [1:28:14<05:57, 35.71s/it]humaneval:  95%|█████████▍| 155/164 [1:28:48<05:16, 35.12s/it]humaneval:  95%|█████████▌| 156/164 [1:29:27<04:49, 36.19s/it]humaneval:  96%|█████████▌| 157/164 [1:30:03<04:14, 36.29s/it]humaneval:  96%|█████████▋| 158/164 [1:30:37<03:32, 35.42s/it]humaneval:  97%|█████████▋| 159/164 [1:31:11<02:55, 35.06s/it]humaneval:  98%|█████████▊| 160/164 [1:31:45<02:18, 34.64s/it]humaneval:  98%|█████████▊| 161/164 [1:32:19<01:43, 34.56s/it]humaneval:  99%|█████████▉| 162/164 [1:32:52<01:08, 34.26s/it]humaneval:  99%|█████████▉| 163/164 [1:33:25<00:33, 33.85s/it]humaneval: 100%|██████████| 164/164 [1:33:58<00:00, 33.58s/it]humaneval: 100%|██████████| 164/164 [1:33:58<00:00, 34.38s/it]
